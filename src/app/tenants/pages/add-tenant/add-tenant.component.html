<section class="content">
    <div class="content-block">
        <div class="block-header">
            <!-- breadcrumb -->
            <app-breadcrumb [title]="'Add Tenant'" [items]="['Tenants']" [active_item]="'tenants'">
            </app-breadcrumb>
        </div>
        <div class="content-block">
            <div class="row clearfix">
                <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12">
                    <div class="card">
                        <div class="header">
                            <h2>Add Tenant</h2>
                        </div>
                        <div class="body">
                            <form [formGroup]="tenantForm" class="m-4">
                                <div class="row">
                                    <div class="col-xl-4 col-lg-4 col-md-12 col-sm-12 mb-3">
                                        <mat-form-field class="example-full-width mb-3" appearance="outline">
                                            <mat-label>Tenant Name</mat-label>
                                            <input formControlName="tenantName" matInput required pattern="[a-zA-Z '-]*"
                                            (keypress)="onKeyPress($event)" />
                                            <mat-error *ngIf="tenantForm.get('tenantName').hasError('required')">
                                                Tenant name is required
                                            </mat-error>
                                        </mat-form-field>
                                    </div>
                                    <div class="col-xl-3 col-lg-3 col-md-12 col-sm-12 mb-3">
                                        <mat-form-field class="example-full-width mb-3" appearance="outline">
                                            <mat-label>Tenant Phone Number</mat-label>
                                            <input formControlName="tenantPhoneNumber" matInput type="text" required />
                                            <mat-error *ngIf="tenantForm.get('tenantPhoneNumber').hasError('required')">
                                                Tenant phone number is required
                                            </mat-error>
                                        </mat-form-field>
                                    </div>
                                    <div class="col-xl-4 col-lg-4 col-md-12 col-sm-12 mb-3">
                                        <mat-form-field class="example-full-width mb-3" appearance="outline">
                                            <mat-label>Tenant Email Address</mat-label>
                                            <input formControlName="tenantEmailAddress" matInput type="email" />

                                        </mat-form-field>
                                    </div>
                                    <div class="row">

                                        <div class="col-xl-4 col-lg-4 col-md-12 col-sm-12 mb-0">
                                            <mat-form-field class="example-full-width" appearance="outline">
                                                <mat-label>Select Identification Type</mat-label>
                                                <mat-select formControlName="identificationType" required>
                                                    <mat-option value="ID Number">ID Number</mat-option>
                                                    <mat-option value="Passport">Passport</mat-option>
                                                    <mat-option value="Registration Number">Registration
                                                        Number</mat-option>
                                                </mat-select>
                                                <mat-error
                                                    *ngIf="tenantForm.get('identificationType').hasError('required')">
                                                    Owner Type is required
                                                </mat-error>
                                            </mat-form-field>
                                        </div>
                                        <div class="col-xl-3 col-lg-3 col-md-12 col-sm-12 mb-3">
                                            <mat-form-field class="example-full-width mb-3" appearance="outline">
                                                <mat-label>Tenant Identification/Reg Number</mat-label>
                                                <input formControlName="identificationNumber" matInput required />
                                                <mat-error
                                                    *ngIf="tenantForm.get('identificationNumber').hasError('required')">
                                                    Identification Number is required
                                                </mat-error>
                                            </mat-form-field>
                                        </div>
                                        <!-- <div class="col-xl-2 col-lg-2 col-md-12 col-sm-12 mb-3">
                                            <button mat-raised-button color="primary" (click)="verify()">
                                                <b>Verify</b>
                                            </button>
                                        </div> -->

                                    </div>
                                <div class="col-xl-4 col-lg-4 col-md-12 col-sm-12 mb-3">
                                        <mat-form-field class="example-full-width mb-3" appearance="outline">
                                            <mat-label>Tenant Occupation</mat-label>
                                            <input formControlName="tenantOccupation" matInput required pattern="[a-zA-Z '-]*"
                                            (keypress)="onKeyPress($event)"/>
                                        </mat-form-field>
                                    </div>
                                    
                                        <div class="col-xl-4 col-lg-4 col-md-12 col-sm-12 mb-0">
                                            <mat-form-field class="example-full-width mb-1" appearance="outline">
                                                <mat-label>Select payment period</mat-label>
                                                <mat-select formControlName="category">
                                                    <mat-option value="Master">Monthly</mat-option>
                                                    <mat-option value="Detached">Quatery</mat-option>
                                                    <mat-option value="Detached">Semi-Anually</mat-option>
                                                    <mat-option value="Detached">Yearly</mat-option>
                                                </mat-select>
                                            </mat-form-field>
                                        </div>

                                </div>
                                <div class="row">
                                    <div class="col-xl-4 col-lg-4 col-md-12 col-sm-12 mb-3">
                                        <!-- File upload for PDF -->
                                        <mat-label>Upload ID</mat-label>
                                        <input class="form-controls mt-2" type="file"
                                            (change)="onIDChange($event)">
                                        <div class="form-group">
                                            <img [src]="this.id" *ngIf="this.id" class="col-md-12 img-preview mt-2">
                                        </div>
                                    </div>
                                </div>


                                <!-- Next Of Kin -->
                               
                                    <mat-card-header>
                                        <mat-card-title>Next Of Kin</mat-card-title>
                                    </mat-card-header>
                                    <div class="row">
                                        <div class="col-xl-4 col-lg-4 col-md-12 col-sm-12 mb-3">
                                            <form [formGroup]="nextOfKinForm">
                                                <mat-form-field class="example-full-width mb-3" appearance="outline">
                                                    <mat-label>Next Of Kin Name</mat-label>
                                                    <input formControlName="nextOfKinName" matInput required pattern="[a-zA-Z '-]*"
                                                    (keypress)="onKeyPress($event)" />
                                                </mat-form-field>
                                            </form>
                                        </div>
                                        <div class="col-xl-4 col-lg-4 col-md-12 col-sm-12 mb-3">
                                            <form [formGroup]="nextOfKinForm">
                                                <mat-form-field class="example-full-width mb-3" appearance="outline">
                                                    <mat-label>Next Of Kin Id Number</mat-label>
                                                    <input formControlName="nextOfKinIdNumber" matInput type="number" />
                                                </mat-form-field>
                                            </form>
                                        </div>
                                        <div class="col-xl-4 col-lg-4 col-md-12 col-sm-12 mb-3">
                                            <form [formGroup]="nextOfKinForm">
                                                <mat-form-field class="example-full-width mb-3" appearance="outline">
                                                    <mat-label>Next Of Kin Email Address</mat-label>
                                                    <input formControlName="nextOfKinEmailAddress" matInput="email" />
                                                </mat-form-field>
                                            </form>
                                        </div>
                                        <div class="col-xl-4 col-lg-4 col-md-12 col-sm-12 mb-3">
                                            <form [formGroup]="nextOfKinForm">
                                                <mat-form-field class="example-full-width mb-3" appearance="outline">
                                                    <mat-label>Next Of Kin Relationship</mat-label>
                                                    <input formControlName="nextOfKinRelationship" matInput required pattern="[a-zA-Z '-]*"
                                                    (keypress)="onKeyPress($event)" />
                                                </mat-form-field>
                                            </form>
                                        </div>

                                        <div class="col-xl-4 col-lg-4 col-md-12 col-sm-12 mb-3">
                                            <form [formGroup]="nextOfKinForm">
                                                <mat-form-field class="example-full-width mb-3" appearance="outline">
                                                    <mat-label>Next Of Kin Phone Number</mat-label>
                                                    <input formControlName="nextOfKinPhoneNumber"type="number" matInput />
                                                </mat-form-field>
                                            </form>
                                        </div>
                                    </div>
                               

                                <!-- List of members moving in with -->
                               
                                    <mat-card-header>
                                        <mat-card-title>Members</mat-card-title>
                                    </mat-card-header>
                                    <div class="row">
                                        <!-- Member Form -->
                                        <form [formGroup]="membersForm">
                                            <div class="row">
                                                <div class="col-xl-3 col-lg-3 col-md-12 col-sm-12 mb-3">
                                                    <mat-form-field class="example-full-width mb-3"
                                                        appearance="outline">
                                                        <mat-label>Member Name</mat-label>
                                                        <input formControlName="name" matInput required pattern="[a-zA-Z '-]*"
                                                        (keypress)="onKeyPress($event)"/>
                                                        <mat-error *ngIf="membersForm.get('name').hasError('required')">
                                                            Member Name is required
                                                        </mat-error>
                                                    </mat-form-field>
                                                </div>

                                                <div class="col-xl-4 col-lg-4 col-md-12 col-sm-12 mb-3">
                                                    <mat-form-field class="example-full-width mb-3"
                                                        appearance="outline">
                                                        <mat-label>Member ID</mat-label>
                                                        <input formControlName="idNumber" matInput type="number" />
                                                    </mat-form-field>
                                                </div>
                                                <div class="col-xl-4 col-lg-4 col-md-12 col-sm-12 mb-3">
                                                    <mat-form-field class="example-full-width mb-3"
                                                        appearance="outline">
                                                        <mat-label>Member Relationship</mat-label>
                                                        <input formControlName="relationship" matInput required pattern="[a-zA-Z '-]*"
                                                        (keypress)="onKeyPress($event)"/>
                                                        <mat-error
                                                            *ngIf="membersForm.get('relationship').hasError('required')">
                                                            Member Relationship is required
                                                        </mat-error>
                                                    </mat-form-field>
                                                </div>
                                            </div>
                                            <div class="col-xl-4 col-lg-4 col-md-12 col-sm-12 mb-3">
                                                <!-- Add to Table Button -->
                                                <button mat-mini-fab color="primary" (click)="addMemberToTable()">
                                                    <mat-icon>add</mat-icon>
                                                </button>
                                            </div>

                                        </form>
                                    </div>

                                    <!-- Member Details Table -->
                                    <div class="row">
                                        <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12">
                                            <table mat-table [dataSource]="memberTableDataSource"
                                                class="table table-bordered table-hover w-100">
                                                <ng-container matColumnDef="name">
                                                    <th mat-header-cell *matHeaderCellDef> Member Name </th>
                                                    <td mat-cell *matCellDef="let element"> {{ element.name }}
                                                    </td>
                                                </ng-container>
                                                <ng-container matColumnDef="relationship">
                                                    <th mat-header-cell *matHeaderCellDef> Member Relationship
                                                    </th>
                                                    <td mat-cell *matCellDef="let element"> {{
                                                        element.relationship
                                                        }}
                                                    </td>
                                                </ng-container>
                                                <ng-container matColumnDef="idNumber">
                                                    <th mat-header-cell *matHeaderCellDef> Member ID </th>
                                                    <td mat-cell *matCellDef="let element"> {{ element.idNumber
                                                        }}
                                                    </td>
                                                </ng-container>

                                                <tr mat-header-row
                                                    *matHeaderRowDef="['name', 'relationship', 'idNumber']">
                                                </tr>
                                                <tr mat-row
                                                    *matRowDef="let row; columns: ['name', 'relationship', 'idNumber']">
                                                </tr>
                                            </table>
                                        </div>
                                    </div>
                               
                                <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 mb-2">
                                    <div class="example-button-row" align="end">
                                        <button mat-raised-button color="warn" routerLink="/tenants/manage"
                                            tabindex="-1">
                                            Cancel
                                        </button>
                                        <p *ngIf="submissionStatus" class="submission-status">{{
                                            submissionStatus }}
                                        </p>
                                        <button mat-raised-button color="primary" [disabled]="!tenantForm.valid"
                                            (click)="addTenant()">
                                            <span *ngIf="loading" class="spinner-border spinner-border-sm mr-1"></span>
                                            <b>Submit</b>
                                        </button>
                                    </div>
                                </div>

                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>